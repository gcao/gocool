h2. Application

h3. Configuration

h3. Models

 * named_scope to scope

h3. Controllers

 * Change Rails Metal MyTurnChecker to regular controller

h3. Views

h2. Dependencies

 * Remove gems/plugins that are not absolutely needed to display the non-admin pages
 * Change plugins to gems

h3. discuz_int

h2. Misc

 * Problem: undefined method `each' for false:FalseClass
   Solution: add some content to all localization files.

h2. EC2 cut over notes

 * Restore instance from yesterday's backup
   $ restore_instance
 * Connect to new instance
   $ ssh root@`new_instance`
 * Upgrade rubygems and install bundler
   $ gem update --system
   $ gem install bundler
 * Update passenger
   $ gem update passenger
   $ passenger-install-apache2-module
   $ vi /etc/apache2/sites-enabled/gocool.conf

LoadModule passenger_module /usr/lib/ruby/gems/1.8/gems/passenger-2.2.15/ext/apache2/mod_passenger.so
PassengerRoot /usr/lib/ruby/gems/1.8/gems/passenger-2.2.15
PassengerRuby /usr/bin/ruby1.8

  <Directory /data/apps/gocool/current/public>
    Options FollowSymLinks
    Options -MultiViews
    AllowOverride all
    Order allow,deny
    Allow from all
  </Directory>

	 $ apache2ctl restart
	
 * Start rails server from console and access app
   $ cd gocool ; script/rails s
   $ curl http://localhost:3000

 * Test whole app and the forum after logged in

 * Associate IP to the new instance
   $ ec2-associate-address IP -i INSTANCE

h2. Upgrade planning

h3. Requirement

 * 3 hours
 * Upgrade on new EC2 instance and switch after thoroughly tested
 * Test thoroughly
 ** Guest
 ** Logged in
 ** Forum integration
 ** Create/accept invitation
 ** Play/undo

h3. Steps

 * Post on forum
 * Start new instance
 * Update deploy.rb
 * Modify config files on server
 * Upgrade through Capistrano
 * Start up application
 * Check application and integration
 * Fix and automate manual steps
 * Run chef script
 * Check application
 * Switch over to new instance (point public IP to new instance)
 * Post on forum
 
h3. Misc

 * Note down anything that is different from expected behaviour
 * Update config/deployment script whenever necessary and test out the changes
